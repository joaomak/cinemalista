var Bamboo=function(t,s){function o(){var i=!1;return"ontouchstart"in t||t.DocumentTouch&&s instanceof DocumentTouch?(i=!0,$("html").addClass("touch")):$("html").addClass("pointer"),i}function n(){var i=0;return navigator.userAgent.match(/(iPhone|iPod)/i)&&-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("CriOS")&&(i=60),"standalone"in t.navigator&&t.navigator.standalone&&(i=0),i}function e(){var i,o=s.createElement("p"),n={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};s.body.insertBefore(o,null);for(var e in n)void 0!==o.style[e]&&(o.style[e]="translate3d(1px,1px,1px)",i=t.getComputedStyle(o).getPropertyValue(n[e]));return s.body.removeChild(o),void 0!==i&&i.length>0&&"none"!==i}var h=$(".open"),r=$("#container"),a=null,d=o(),u=n(),e=e(),p=e?" translateZ(0)":"",c="onorientationchange"in t?"orientationchange":"resize",f=d?"touchstart":"mousedown",l=d?"touchmove":"mousemove",m=d?"touchend":"mouseup",g=function(s){this.options={menu:!0,breakpoint:768,menuWidth:265,headerHeight:50,snapThreshold:null,resize:null};for(i in s)this.options[i]=s[i];this.resizeSite(),a=$('<div id="block" />'),r.find("#scroller").append(a),$(t).on(c,this.resizeSite.bind(this)),r.on(f,this._start.bind(this)),r.on(l,this._move.bind(this)),r.on(m,this._end.bind(this))};return g.prototype={info:{},x:0,dx:0,ox:null,tgt:null,desktop:!1,dimensions:function(){return[this.info.docWidth,this.info.docHeight]},offset:function(){return u},resizeSite:function(){this.info.docHeight=$(t).height(),this.info.docWidth=$(t).width(),this.layout(),this.snapThreshold=null===this.options.snapThreshold?Math.round(.25*this.info.docWidth):/%/.test(this.options.snapThreshold)?Math.round(this.info.docWidth*this.options.snapThreshold.replace("%","")/100):this.options.snapThreshold,this.options.resize&&this.options.resize()},layout:function(){this.info.docWidth<this.options.breakpoint?(this.desktop=!1,r.css({width:this.info.docWidth,height:"auto"}),r.find("#scroller").css({height:this.info.docHeight+u-this.options.headerHeight})):(this.desktop=!0,r.css({width:this.info.docWidth-this.options.menuWidth,height:this.info.docHeight+u}),r.find("#scroller").css({height:"auto"})),this.hideAddressBar()},hideAddressBar:function(){setTimeout(function(){t.scrollTo(0,1)},50)},_start:function(t){if(!this.initiated&&!this.desktop&&this.options.menu){$("#console").html("start");var i=d?t.originalEvent.touches[0]:t;this.initiated=!0,this.pointX=i.pageX,this.pointY=i.pageY,this.stepsX=0,this.stepsY=0,this.directionLocked=!1,this.x=r.offset().left,this.ox=-this.x+this.pointX,this.tgt=$(t.target),r.css({"transition-duration":"0s"})}},_move:function(t){if(this.initiated&&!this.desktop&&this.options.menu){$("#console").html("move");var i=d?t.originalEvent.touches[0]:t;if(this.stepsX+=Math.abs(i.pageX-this.pointX),this.stepsY+=Math.abs(i.pageY-this.pointY),!(this.stepsX<10&&this.stepsY<10)){if(!this.directionLocked&&this.stepsY>this.stepsX)return this.initiated=!1,void 0;if(t.preventDefault(),this.directionLocked=!0,this.ox){var s=parseInt(i.pageX)-this.ox;this.dx=s-this.x,this.x=s,s>0&&this._moveContainer(s)}}}},_end:function(t){if(this.initiated&&!this.desktop&&this.options.menu){var i=d?t.originalEvent.changedTouches[0]:t,s=parseInt(i.pageX)-this.ox;this.dx<=0?this._animateTo(s,0):this._animateTo(s,this.options.menuWidth),0===this.dx&&0===s&&this.tgt.is(h)&&this._animateTo(this.options.menuWidth,this.options.menuWidth),this.ox=null,this.dx=0,this.initiated=!1}},_animateTo:function(t,i){r.css({"transition-duration":Math.floor(100*t/this.snapThreshold)+"ms",transform:"translate("+i+"px,0)"+p}),this._toggleCover(i)},_moveContainer:function(t){r.css({transform:"translate("+t+"px,0)"+p})},_toggleCover:function(t){t>this.options.menuWidth-50?a.show():a.hide()}},g}(window,document);