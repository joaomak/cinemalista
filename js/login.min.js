var googleapi={authorize:function(e){var o=$.Deferred(),t="https://accounts.google.com/o/oauth2/auth?"+$.param({client_id:e.client_id,redirect_uri:e.redirect_uri,response_type:"code",scope:e.scope}),r=window.open(t,"_blank","location=no,toolbar=no");return $(r).on("loadstart",function(t){var n=t.originalEvent.url,c=/\?code=(.+)$/.exec(n),i=/\?error=(.+)$/.exec(n);(c||i)&&r.close(),c?$.post("https://accounts.google.com/o/oauth2/token",{code:c[1],client_id:e.client_id,client_secret:e.client_secret,redirect_uri:e.redirect_uri,grant_type:"authorization_code"}).done(function(e){o.resolve(e)}).fail(function(e){o.reject(e.responseJSON)}):i&&o.reject({error:i[1]})}),o.promise()},getinfo:function(){$.post("https://accounts.google.com/o/oauth2/token",{code:code[1],client_id:options.client_id,client_secret:options.client_secret,redirect_uri:options.redirect_uri,grant_type:"authorization_code"}).done(function(e){deferred.resolve(e)}).fail(function(e){deferred.reject(e.responseJSON)})}};$(document).on("ready",function(){var e=$(".login");e.on("click",function(){googleapi.authorize({client_id:"828831281117.apps.googleusercontent.com",client_secret:"xZrAvMkJAtFoFCU0ri3Nu7Rv",redirect_uri:"http://localhost",scope:"https://www.googleapis.com/auth/analytics.readonly"}).done(function(e){alert(e.access_token),alert(e.id_token)}).fail(function(e){alert(e.error)})})});